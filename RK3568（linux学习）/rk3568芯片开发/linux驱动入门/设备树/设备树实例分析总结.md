---
title: 
aliases: 
tags: 
description:
---

# 随记：




# 一、485设备树配置
## 1、使用gpio引脚（设置引脚复用）
### 说明使用的引脚
>         rk_485_ctl: rk-485-crl{
            compatible="topeet,rs485_ctl";
            `gpios=<&gpio0 22 GPIO_ACTIVE_HIGH>;
            `pinctrl-names="default";
            `pinctrl-0=<&rk_485_gpio>;
>             
>         };

- 1 支持同时定义多个引脚（以逗号分隔)


### pinctrl设置复用
> &pinctrl{
	rk_485{
		rk_485_gpio: rk-485-gpio{
			`rockchip,pins=<0 RK_PC6 RK_FUNC_GPIO &pcfg_pull_none>;
> 
> 		};
> 	};
> };
> 

### 宏定义含义总结
#### 电气特性配置（Electrical Properties）​​

| ​**​宏定义​**​                 | ​**​含义​**​     | ​**​应用场景​**​     |
| --------------------------- | -------------- | ---------------- |
| `&pcfg_pull_up`             | 启用内部上拉电阻       | 按键检测（避免浮空）       |
| `&pcfg_pull_down`           | 启用内部下拉电阻       | 默认稳定低电平需求        |
| `&pcfg_pull_none`           | 禁用上下拉（浮空状态）    | 高阻态输入或**外部电路控制** |
| `&pcfg_pull_up_drv_level_3` | 上拉+高驱动强度（如8mA） | 驱动LED等需大电流场景     |
|                             |                |                  |

#### 中断控制（Interrupt Configuration）​​

|​**​宏定义​**​|​**​含义​**​|
|---|---|
|`IRQ_TYPE_EDGE_RISING`|上升沿触发|
|`IRQ_TYPE_EDGE_FALLING`|下降沿触发|
|`IRQ_TYPE_EDGE_BOTH`|双边沿触发|
|`IRQ_TYPE_LEVEL_HIGH`|高电平触发|
|`IRQ_TYPE_LEVEL_LOW`|低电平触发|

#### GPIO电平与有效性​​

|​**​宏定义​**​|​**​含义​**​|
|---|---|
|`GPIO_ACTIVE_HIGH`|高电平有效（逻辑1=物理高电平）|
|`GPIO_ACTIVE_LOW`|低电平有效（逻辑1=物理低电平）|
|`GPIOD_IS_OUT`|配置GPIO为输出方向（驱动代码中）|
|`GPIOD_IS_IN`|配置GPIO为输入方向|



## 2、使用定义好的节点

### 设置状态和复用
> &uart7{
>     `status="okay";
>     pinctrl-names = "default";
>     `pinctrl-0=<&uart7m1_xfer>;
> 
> };


### 引用的节点一般在rk3568.dtsi


### Xfer（数据传输）​



## 3、注意 - 书写错误
### `pinctrl-names` 拼写错误

- **问题**：`pinctrl-name = "default";`
    - 属性名应为复数形式 `pinctrl-names`（拼写错误）。


### `pinctrl` 节点位置错误

- **问题**：`&pinctrl` 节点定义在根节点内部（`/ { ... }`），但应作为根节点的同级节点。
    - `pinctrl` 是顶层节点，不应嵌套在 `/` 中。


### 



## 4、
### 


### 


### 




## 5、
### 


### 


### 







# 二、

## 1、
### 


### 


### 


## 2、

### 


### 


### 



## 3、
### 


### 


### 



## 4、
### 


### 


### 




## 5、
### 


### 


### 




# 三、

## 1、
### 


### 


### 


## 2、

### 


### 


### 



## 3、
### 


### 


### 



## 4、
### 


### 


### 




## 5、
### 


### 


### 



# 四、

## 1、
### 


### 


### 


## 2、

### 


### 


### 



## 3、
### 


### 


### 



## 4、
### 


### 


### 




## 5、
### 


### 


### 









# 五、

## 1、
### 


### 


### 


## 2、

### 


### 


### 



## 3、
### 


### 


### 



## 4、
### 


### 


### 




## 5、
### 


### 


### 




# 六、

## 1、
### 


### 


### 


## 2、

### 


### 


### 



## 3、
### 


### 


### 



## 4、
### 


### 


### 




## 5、
### 


### 


### 
