---
title: 
aliases: 
tags: 
description:
---

# 备注(声明)：


# 补充：


# 一、做项目时用到的
## 简介:


[[RK3568（linux学习）/小项目/基于rk3568的智能家居项目/基于rk3568完成智能家居项目#2.2 杂项设备的框架]]
[[RK3568（linux学习）/小项目/基于rk3568的智能家居项目/基于rk3568完成智能家居项目#2.3 字符设备的框架]]


## 1. 杂项设备的框架
[[RK3568（linux学习）/驱动子系统思维导图/注册杂项设备驱动.canvas|杂项设备驱动]]

- 2.2.1 [16-杂项设备驱动](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#16-杂项设备驱动&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={A58AB335-B2E4-4BCD-AF84-26A33C989F0B}&end)  --->基础知识 

- 2.2.2 [杂项设备-通用代码架构](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#杂项设备-通用代码架构&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={EB08A5E5-D6EF-4F41-85EE-4394C92B53D8}&end)

- 2.2.3 [杂项设备驱动的思维导图](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#杂项设备驱动的思维导图&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={D0903E74-5839-407C-AFB6-9D5CA2E579BA}&end)

## 2、字符设备的框架
[[RK3568（linux学习）/驱动子系统思维导图/注册字符设备驱动.canvas|字符设备驱动]]

- 2.3.1 [字符设备-通用代码架构](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#字符设备-通用代码架构&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={D41D0089-859F-44C3-937F-E9EA043CCDAB}&end)

- 2.3.2 [字符设备驱动的思维导图](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#字符设备驱动的思维导图&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={C648B4CD-8BB2-447B-85BD-7F323C6C3E36}&end)


# 二、设备
## 简介:


## 补充：


## 1.设备号
### 1.1 设备号-操作宏和分配函数
[1-设备号-操作宏和分配函数](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#1-设备号-操作宏和分配函数&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={A3B6E2AC-B252-45EB-BF49-66ED06A00117}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F1-%E8%AE%BE%E5%A4%87%E5%8F%B7-%E6%93%8D%E4%BD%9C%E5%AE%8F%E5%92%8C%E5%88%86%E9%85%8D%E5%87%BD%E6%95%B0%7CA3B6E2AC-B252-45EB-BF49-66ED06A00117%2F%29&wdpartid=%7bB465771E-6545-4F61-9D3D-05A5CE5B82DF%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 1.2 实例
[2-（代码编写）](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#2-（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={CDC38C60-2C48-4ED6-AABE-637FB6C1B763}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F2-%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7CCDC38C60-2C48-4ED6-AABE-637FB6C1B763%2F%29&wdpartid=%7b9CC55188-CF1C-47C3-9032-D5F8B09F65FF%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 1.3 


### 1.4 


## 2.字符类设备
### 2.1 结构体及其函数
[4-字符类设备-结构体及其函数](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#4-字符类设备-结构体及其函数&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={475988B2-1F2F-48D0-9B1F-88D6682F4E8F}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F4-%E5%AD%97%E7%AC%A6%E7%B1%BB%E8%AE%BE%E5%A4%87-%E7%BB%93%E6%9E%84%E4%BD%93%E5%8F%8A%E5%85%B6%E5%87%BD%E6%95%B0%7C475988B2-1F2F-48D0-9B1F-88D6682F4E8F%2F%29&wdpartid=%7bF777BBAA-1196-482C-81EE-470030F802C9%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 2.2 file_operations结构体
[6-file_operations结构体file_operations结构体-->函数成员](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#6-file_operations结构体file_operations结构体--%3e函数成员&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={B7F13C90-C318-4420-9857-44CD787D3670}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F6-file_operations%E7%BB%93%E6%9E%84%E4%BD%93file_operations%E7%BB%93%E6%9E%84%E4%BD%93--%3E%E5%87%BD%E6%95%B0%E6%88%90%E5%91%98%7CB7F13C90-C318-4420-9857-44CD787D3670%2F%29&wdpartid=%7bF7B97AEA-02C5-4CD9-AA0E-CF6297D0C86E%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 2.3 实例
[（代码编写）](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={BF5DA5BB-E0B8-4960-8C51-8A1F43233F08}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7CBF5DA5BB-E0B8-4960-8C51-8A1F43233F08%2F%29&wdpartid=%7bF81E5E91-D3C5-04BB-158A-E583B12F3BCE%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 2.4 


## 3.设备节点
### 3.1手动创建设备节点 
[7-设备节点-手动创建设备节点](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#7-设备节点-手动创建设备节点&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={1EC3F831-D31F-4743-9F64-9CBDEE1E5937}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F7-%E8%AE%BE%E5%A4%87%E8%8A%82%E7%82%B9-%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BA%E8%AE%BE%E5%A4%87%E8%8A%82%E7%82%B9%7C1EC3F831-D31F-4743-9F64-9CBDEE1E5937%2F%29&wdpartid=%7b1F18AC26-6A11-409B-854E-59B14D8570E3%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

#### 实例
[8-实验](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#8-实验&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={167A617C-4CE9-4961-9D2E-9C20E0A44B72}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F8-%E5%AE%9E%E9%AA%8C%7C167A617C-4CE9-4961-9D2E-9C20E0A44B72%2F%29&wdpartid=%7b5E452341-C7F2-41CC-AA24-686436EAC103%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 3.2 自动创建设备节点
[9-自动创建设备节点- 函数](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#9-自动创建设备节点-%20函数&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={3AD3F484-34F7-466D-9B40-07BA2529E488}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F9-%E8%87%AA%E5%8A%A8%E5%88%9B%E5%BB%BA%E8%AE%BE%E5%A4%87%E8%8A%82%E7%82%B9-%20%E5%87%BD%E6%95%B0%7C3AD3F484-34F7-466D-9B40-07BA2529E488%2F%29&wdpartid=%7b3F0DEB41-6336-4BD5-A152-D5FB713481B8%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

#### 实例
[（代码编写）](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={74A16179-12B2-4177-B1E9-4A9A8F10A1E0}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7C74A16179-12B2-4177-B1E9-4A9A8F10A1E0%2F%29&wdpartid=%7bB8C7A330-5CFA-0D35-232E-25DF5D224A99%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

[10-实验](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#10-实验&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={C085EFAE-A473-447C-899E-B5ED06FB8DC5}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F10-%E5%AE%9E%E9%AA%8C%7CC085EFAE-A473-447C-899E-B5ED06FB8DC5%2F%29&wdpartid=%7b7BAF46F6-F3FD-4CA7-AD24-DBFFFA59F3D3%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))
### 3.3 


### 3.4 



# 三、数据处理
## 简介:


## 补充：


## 1.内核空间与用户空间-数据交换
### 1.1 数据交换函数
[“11-内核空间与用户空间-数据交换函数”页上的图片](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#11-内核空间与用户空间-数据交换函数&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={0A1C1505-4501-4D5C-9F57-D2DF3BB2723B}&object-id={C0456AD7-5521-4EE8-AD75-FA9CC654E6E8}&3A)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F11-%E5%86%85%E6%A0%B8%E7%A9%BA%E9%97%B4%E4%B8%8E%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4-%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E5%87%BD%E6%95%B0%7C0A1C1505-4501-4D5C-9F57-D2DF3BB2723B%2F%29&wdpartid=%7bECBBA37A-A216-4FA4-B1BD-5B14F0A0BEB7%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 1.2 实例
[（代码编写）](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={B01590AF-EEAC-4731-9326-61E08FA66FB6}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7CB01590AF-EEAC-4731-9326-61E08FA66FB6%2F%29&wdpartid=%7b82525CF2-36A8-08C7-3C11-08882BAE02B8%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

[12-数据交互实验](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#12-数据交互实验&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={AABA384F-7AC0-4132-85AB-7909F192305B}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F12-%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92%E5%AE%9E%E9%AA%8C%7CAABA384F-7AC0-4132-85AB-7909F192305B%2F%29&wdpartid=%7b5F77D25B-09B4-42B0-A6FD-B61A10CE5B70%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 1.3 


### 1.4 


## 2.文件私有数据
### 2.1 定义使用
[“13-文件私有数据-private_date”页上的图片](onenote:https://d.docs.live.net/52D4B76BB0FFCF51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#13-文件私有数据-private_date&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={494994D1-C063-4C77-A283-32D27253CFFD}&object-id={807D3C0C-4500-4B2A-ACAB-A47C246EC21D}&12)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F13-%E6%96%87%E4%BB%B6%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE-private_date%7C494994D1-C063-4C77-A283-32D27253CFFD%2F%29&wdpartid=%7b4F28320B-9F93-4D3E-901C-7454DBCE3CF5%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 2.2 代码编写
[（代码编写）](onenote:https://d.docs.live.net/52D4B76BB0FFCF51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={F46628BC-F38E-4D63-A05F-1A26625AED55}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7CF46628BC-F38E-4D63-A05F-1A26625AED55%2F%29&wdpartid=%7b8CA6678D-F4B5-06E3-38C4-3185D43C3130%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 2.3 使用场景-一个驱动兼容不同设备

- 代码编写-主设备号相同,  次设备号不同
[（代码编写）](onenote:https://d.docs.live.net/52D4B76BB0FFCF51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={7CC8F716-1BF2-4934-80A7-818AD5BC53FA}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7C7CC8F716-1BF2-4934-80A7-818AD5BC53FA%2F%29&wdpartid=%7b40B3F416-FDB4-0C42-0D65-9880C2EAB057%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))


### 2.4 顺藤摸瓜获取结构体函数
[“14-私有数据的使用场景-主设备号相同, 次设备号不同”页上的图片](onenote:https://d.docs.live.net/52D4B76BB0FFCF51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#14-私有数据的使用场景-主设备号相同,%20%20次设备号不同&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={80798AD1-ED8D-4C58-944B-49D095C4C34E}&object-id={FE5756A6-9731-4E06-8753-89F5E7D5067A}&26)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F14-%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-%E4%B8%BB%E8%AE%BE%E5%A4%87%E5%8F%B7%E7%9B%B8%E5%90%8C%2C%20%20%E6%AC%A1%E8%AE%BE%E5%A4%87%E5%8F%B7%E4%B8%8D%E5%90%8C%7C80798AD1-ED8D-4C58-944B-49D095C4C34E%2F%29&wdpartid=%7bE263DA65-AAFE-4B77-9E58-F3DBA0393623%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

## 3.Linux驱动错误处理-goto语句
### 3.1 Linux错误码
[“18-Linux驱动错误处理”页上的图片](onenote:https://d.docs.live.net/52D4B76BB0FFCF51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#18-Linux驱动错误处理&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={C1343091-C0B8-4AA7-BB12-D86846C048EC}&object-id={25B72A58-4243-4359-B3CE-B8B020D37363}&2D)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F18-Linux%E9%A9%B1%E5%8A%A8%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%7CC1343091-C0B8-4AA7-BB12-D86846C048EC%2F%29&wdpartid=%7b405B7C0E-4C4A-4796-8EBC-F160468E140E%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 3.2 指针返回值的错误判断-IS_ERR / PTR_ERR
[“18-Linux驱动错误处理”页上的图片](onenote:https://d.docs.live.net/52D4B76BB0FFCF51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#18-Linux驱动错误处理&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={C1343091-C0B8-4AA7-BB12-D86846C048EC}&object-id={25B72A58-4243-4359-B3CE-B8B020D37363}&37)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F18-Linux%E9%A9%B1%E5%8A%A8%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%7CC1343091-C0B8-4AA7-BB12-D86846C048EC%2F%29&wdpartid=%7b405B7C0E-4C4A-4796-8EBC-F160468E140E%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))



### 3.3 代码实验
[（代码编写）](onenote:https://d.docs.live.net/52D4B76BB0FFCF51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={0499AA6B-2951-4161-A511-9700F3E5E30B}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7C0499AA6B-2951-4161-A511-9700F3E5E30B%2F%29&wdpartid=%7bB4876C14-0C49-04B7-1131-E8259C9BD12E%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 3.4 





# 四、驱动实验-点亮一个LED灯
## 简介:
[19-点亮一个LED（基于RK3568）](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#19-点亮一个LED（基于RK3568）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={4A374F1E-70E3-41E2-869D-C524C849647F}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F19-%E7%82%B9%E4%BA%AE%E4%B8%80%E4%B8%AALED%EF%BC%88%E5%9F%BA%E4%BA%8ERK3568%EF%BC%89%7C4A374F1E-70E3-41E2-869D-C524C849647F%2F%29&wdpartid=%7b2A2D0CEC-D87C-4137-8BB5-214A58BA7E30%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))


## 补充：


## 1.实验步骤 
### 1.1找到 led灯是哪个GPIO 控制-通过底板原理图
[“19-点亮一个LED（基于RK3568）”页上的绘图](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#19-点亮一个LED（基于RK3568）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={4A374F1E-70E3-41E2-869D-C524C849647F}&object-id={3F0A953F-C18F-43FA-99D2-93EC86B69763}&FF)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F19-%E7%82%B9%E4%BA%AE%E4%B8%80%E4%B8%AALED%EF%BC%88%E5%9F%BA%E4%BA%8ERK3568%EF%BC%89%7C4A374F1E-70E3-41E2-869D-C524C849647F%2F%29&wdpartid=%7b2A2D0CEC-D87C-4137-8BB5-214A58BA7E30%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 1.2 配置 GPIO(复用关系，方向，数据)
[“19-点亮一个LED（基于RK3568）”页上的图片](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#19-点亮一个LED（基于RK3568）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={4A374F1E-70E3-41E2-869D-C524C849647F}&object-id={3F0A953F-C18F-43FA-99D2-93EC86B69763}&AA)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F19-%E7%82%B9%E4%BA%AE%E4%B8%80%E4%B8%AALED%EF%BC%88%E5%9F%BA%E4%BA%8ERK3568%EF%BC%89%7C4A374F1E-70E3-41E2-869D-C524C849647F%2F%29&wdpartid=%7b2A2D0CEC-D87C-4137-8BB5-214A58BA7E30%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

### 1.3 将物理地址转成虚拟地址的函数-ioremap
**驱动开发中访问硬件寄存器的必备工具**。
#### **2函数原型**

```
#include <linux/io.h> // 声明 ioremap 和相关函数

void __iomem *ioremap(resource_size_t phys_addr, unsigned long size);
```
- **参数**：
    - `phys_addr`：要映射的物理地址的<span style="background:#d3f8b6">起始地址</span>。
    - `size`：要映射的内存区域的<span style="background:#d3f8b6">大小</span>（单位：字节）。
- **返回值**：
    - 成功：返回映射后的内核虚拟地址（类型 `void __iomem *`）。
    - 失败：返回 `NULL`（如内存不足或地址无效）。

<span style="background:#affad1">我们要操作硬件的虚拟地址才行</span>

#### **实验：**
[“（代码编写）”页上的图片](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={A15F6785-2EBC-4B02-A9DE-56334018D5F2}&object-id={1F86EE8E-E876-0FAD-1494-E8A01BF4C7EF}&63)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7CA15F6785-2EBC-4B02-A9DE-56334018D5F2%2F%29&wdpartid=%7bB1A2F243-9933-01F2-16A5-7EE671D6E6D0%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))

## 2.代码编写
[（代码编写）](onenote:https://d.docs.live.net/52d4b76bb0ffcf51/Documents/\(RK3568\)Linux驱动开发/第二期_字符设备基础.one#（代码编写）&section-id={6884B65C-1566-4D91-888F-B6B0A75BF2AA}&page-id={A15F6785-2EBC-4B02-A9DE-56334018D5F2}&end)  ([Web 视图](https://onedrive.live.com/view.aspx?resid=52D4B76BB0FFCF51%21se8c325913f784bf694d429e5ee2ab2be&id=documents&wd=target%28%E7%AC%AC%E4%BA%8C%E6%9C%9F_%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E5%9F%BA%E7%A1%80.one%7C6884B65C-1566-4D91-888F-B6B0A75BF2AA%2F%EF%BC%88%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%EF%BC%89%7CA15F6785-2EBC-4B02-A9DE-56334018D5F2%2F%29&wdpartid=%7bB1A2F243-9933-01F2-16A5-7EE671D6E6D0%7d%7b1%7d&wdsectionfileid=52D4B76BB0FFCF51!s8d412ca600d24139b11cd4565fd2e547))
<span style="background:#b1ffff">使用io命令控制寄存器</span>