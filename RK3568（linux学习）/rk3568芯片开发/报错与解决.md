---
title: 
aliases: 
tags: 
description:
---

# 随记：



# 一、
## 1、
### 报错现象


### 原因 - `/etc/apt/sources.list` 文件中多次配置了 `Commands-all` 目标的 CNF
```bash
deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ bionic stable
# deb-src [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ bionic stable
deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu bionic stable

```

### 解决 - 把重复的去掉一个就可
```bash
deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ bionic stable
# deb-src [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ bionic stable
# deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu bionic stable

```



## 2、`libcurl4-gnutls-dev` 和 `libcurl3gnutls/libcurl4` 之间的依赖冲突问题
### 报错现象
> 下列软件包有未满足的依赖关系： libcurl4-gnutls-dev : 依赖: libcurl3-gnutls (= 7.58.0-2ubuntu3) 但是 7.58.0-2ubuntu3.24 正要被安装 E: 无法修正错误，因为您要求某些软件包保持现状，就是它们破坏了软件包间的依赖关系。
> 
### 原因


### 解决
### 🔄 解决方案 2：移除 libcurl3 然后安装libcurl4

如果当前系统装有 `libcurl3-gnutls`，先移除它：

`sudo apt remove libcurl3-gnutls 
`sudo apt update sudo apt install libcurl4-gnutls-dev`

这将释放冲突依赖，允许安装最新版 。


## 3、虚拟机ubuntu内部删除的文件没有完全释放
### 报错现象


### 原因


### 解决

[虚拟机磁盘瘦身(虚拟机内删除文件后，所占物理空间不变小)\_虚拟机的文件删除以后物理及所占用的空间也会立即释放-CSDN博客](https://blog.csdn.net/weixin_42741271/article/details/97256803)
## 4、
### 报错现象


### 原因


### 解决




## 5、
### 报错现象


### 原因


### 解决






# 二、定制 Ubuntu 和 Debian 系统到开发板
## 1、虚拟机ubuntu卡死关不了机
### 报错现象


### 原因


### 解决
[Title Unavailable \| Site Unreachable](https://cloud.tencent.com/developer/article/2395367)

## 2、Archives directory /var/cache/apt/archives/partial is missing
### 报错现象
> The following additional packages will be installed:
  vim-common vim-runtime
Suggested packages:
  ctags vim-doc vim-scripts
`E: Archives directory /var/cache/apt/archives/partial is missing. - Acquire (2: No such file or directory)
ERROR: Running build_ubuntu20 failed!
ERROR: exit code 100 from line 462:
    VERSION=ubuntu20 ./mk-rootfs.sh


### 原因 


### 解决

> `E: Archives directory /var/cache/apt/archives/partial is missing. - Acquire (2: No such file or directory)
> root@ubuntu:/# `mkdir -p /var/cache/apt/archives/partial
> root@ubuntu:/# `mkdir -p /var/lib/apt/lists/partial
> root@ubuntu:/# `chmod 755 /var/cache/apt/archives
> root@ubuntu:/# `chmod 755 /var/lib/apt/lists
> root@ubuntu:/# `apt update
> 
> root@ubuntu:/# `apt-get install vim
> 
> 
## 3、
### 报错现象


### 原因


### 解决



## 4、
### 报错现象


### 原因


### 解决




## 5、
### 报错现象


### 原因


### 解决






# 三、实时系统
## 1、编译xenomai和preemtion的kernel失败

### Ubuntu 编译环境缺少 `libgmp-dev` 开发包
> ==========================================
>           Start building kernel
> ==========================================
> 
> Your gmp headers are missing
> Please install it:
> `sudo apt-get install libgmp-dev
> 
> ERROR: Running /home/topeet/Linux/beijing/3568-linux/device/rockchip/common/scripts/mk-kernel.sh - do_build failed!
> ERROR: exit code 1 from line 49:
>     "$SCRIPTS_DIR/check-kernel.sh"
> ERROR: call stack:
>     mk-kernel.sh: do_build(49)
- 1 sudo apt-get install libgmp-dev


### 系统里没有安装 Expect
> make: Leaving directory '/home/topeet/Linux/beijing/3568-linux/buildroot'
> Done in 0s  (error code: 1)
> Failed to build rockchip_rk3568:
> # 2025-07-21 05:30:26
> 2025-07-21T05:30:26 `can't find package Expect`
> 2025-07-21T05:30:26 while executing
> 2025-07-21T05:30:26 "package require Expect"
> 2025-07-21T05:30:26 (file "/usr/bin/unbuffer" line 6)
> 
> Please check details in /home/topeet/Linux/beijing/3568-linux/output/sessions/2025-07-21_05-26-33/br-rockchip_rk3568_2025-07-21_05-30-26.log
> 
- 1 系统里没有安装 Expect，就会出现类似错误，解决办法：安装 Expect 套件
- 2 sudo apt update
- 2 sudo apt install expect tcl-expect


### tclsh路经错误，当前 `tclsh` 是 Miniconda 自带的版本
> (base) topeet@ubuntu:~/Linux/beijing/3568-linux$ `which tclsh`
> `/home/topeet/miniconda3/bin/tclsh`
> (base) topeet@ubuntu:~/Linux/beijing/3568-linux$ tclsh --version
> % ^C
- 1 你当前 `tclsh` 是 Miniconda 自带的版本，而不是系统自带的，这导致 `unbuffer` 脚本执行 `package require Expect` 时找不到 Expect 库。

- 1 方法一：用临时 PATH 跳过 Conda
- 2 PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin unbuffer echo ok
- 2 export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin    在你的 `build.sh` 或 `mk-rootfs.sh` 前加入类似
> (base) topeet@ubuntu:~/Linux/beijing/3568-linux$ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin unbuffer echo ok
> ok
> (base) topeet@ubuntu:~/Linux/beijing/3568-linux$ ./build.sh all


- 1 方法二：长期方案   **编辑 `/usr/bin/unbuffer`**，将第一个 `exec tclsh` 改为：
- 2 exec /usr/bin/tclsh "$0" ${1+"$@"}


### ubuntu29.04  GCC 版本过低

> `gcc: error: unrecognized command line option '-Waddress-of-packed-member'
这是由于你的交叉编译器或主机上安装的 GCC 版本过低，不支持 `-Waddress-of-packed-member` 选项，该选项从 GCC 9 开始引入

- 1 ubuntu20因为全志的开发可以切换gcc版本
[[报错与解决-wiki#切换gcc版本]]


### 



## 2、
### 报错现象


### 原因


### 解决



## 3、
### 报错现象


### 原因


### 解决



## 4、
### 报错现象


### 原因


### 解决




## 5、
### 报错现象


### 原因


### 解决

# 四、系统开发
## 1、配置IO电压域讲解（每一个系统都要）
### 报错现象


### 原因


### 解决（kernel/arch/arm64/boot/dts/rockchip/rk3568-evb.dtsi）

> &pmu_io_domains {
> 	status = "okay";
> 	pmuio2-supply = <&vcc3v3_pmu>;
> 	vccio1-supply = <&vccio_acodec>;//3.3V
> 	vccio3-supply = <&vccio_sd>;//1.8~3.3V
> 	vccio4-supply = <&vcc_1v8>;
> 	vccio5-supply = <&vcc_3v3>;
> 	vccio6-supply = <&vcc_1v8>;
> 	vccio7-supply = <&vcc_3v3>;
> };
> 

```
&pmu_io_domains {
	status = "okay";
	pmuio2-supply = <&vcc3v3_pmu>;
	vccio1-supply = <&vccio_acodec>;//3.3v
	vccio3-supply = <&vccio_sd>;//1.8~3.3v
	vccio4-supply = <&vcc_1v8>;
	vccio5-supply = <&vcc_3v3>;
	vccio6-supply = <&vcc_1v8>;
	vccio7-supply = <&vcc_3v3>;
};
```

添加Ubuntu系统

## 2、
### 报错现象


### 原因


### 解决



## 3、
### 报错现象


### 原因


### 解决



## 4、
### 报错现象


### 原因


### 解决




## 5、
### 报错现象


### 原因


### 解决











