---
title: 
aliases: 
tags:
  - 君正T23-ZN
  - 添加文件到系统中
description:
---

# 随记：



# 一、搭建 Camera 基础系统
> [!PDF|important] [[Ingenic_Zeratul_T23_开发指南.pdf#page=9&selection=18,0,24,4&color=important|Ingenic_Zeratul_T23_开发指南, p.9]]
> > 4. 搭建 Camera 基础系统
> 
> 

## 1.系统分区编译

详细内容请参考【Ingenic Zeratul T23 SDK 使用说明】文档。
[[2.系统分区编译]]
## 2.制作并进入 Normal u-boot（不行没config文件）
 > [!PDF|note] [[Ingenic_Zeratul_T23_开发指南.pdf#page=9&selection=38,0,40,13&color=note|Ingenic_Zeratul_T23_开发指南, p.9]]
> > 如何制作并进入 Normal u-boot
> bootload 作为系统的引导程序，进行简单的硬件初始化工作。Zeratul 的 bootload 直接快速引导操作系统，因此不能编程，也没有 u-boot 的命令行功能。如果客户需要进入 u-boot 的命令行进行 debug 或者执行客户订制程序（如 TF 卡升级），可以在<span style="background:#affad1">系统启动后，在命令行输入 recovery 进入 Normal u-boot。</span>
> 

### 概览
- 启动时在 U-Boot 的第一阶段加载完成后，会进入一个简单的升级/恢复环境，此时在命令行输入 `recovery` 即可切换到“Normal U-Boot”（第二阶段）
    
- 第二阶段的 U-Boot 镜像存放在 Flash 的 `boot` 分区（通常是一个名为 `boot.bin` 的文件）
    
- 如果要使用自己定制的 U-Boot，就需要<span style="background:#affad1">把官方的 `boot.bin` 和你编译出的 `u-boot-with-spl.bin` 合并——这正是 `pad_camera_u-boot.sh` 的功能</span>
    
- 脚本底层实际上是把官方 `boot.bin` 的前 32 KB 保留，然后在偏移 32 KB 后写入你自己的 U-Boot 二进制，从而得到一个可直接刷入 `boot` 分区的新文件

### 编译自己的 U-Boot

**U-Boot 源码**在项目树的：os/uboot/u-boot/

**配置文件**
isvp_t23n_msc0                        T23N 卡起 uboot1
isvp_t23n_msc1                         T23N 卡起 uboot2
isvp_t23n_sfcnand                        T23N  可做 NAND u-boot 
isvp_t23n_sfcnor                      T23N 可做 Normal u-boot
isvp_t23zn_msc0                        T23ZN 卡起 uboot1 
isvp_t23zn_msc1                       T23ZN 卡起 uboot2 
isvp_t23zn_sfcnand                  T23ZN 可做 NAND u-boot 
isvp_t23zn_sfcnor                   T23ZN 可做 Normal u-boot



**编译**
```
make distclean
make isvp_t23zn_sfcnor   
```

编译结果会生成一个 `u-boot-with-spl.bin`（SPL + U-Boot 主镜像 合二为一）




### `pad_camera_u-boot.sh` 脚本详解
#### 用法

```
./pad_camera_u-boot.sh \
  -i <input_file>   \   # 你的 u-boot-with-spl.bin
  -o <output_file>  \   # 合并后生成的新 boot 文件  
  -b <boot.bin fw>       # 官方 SDK 自带的 boot.bin（低功耗快起固件）
# 例如：
./pad_camera_u-boot.sh \
  -i u-boot-with-spl.bin \
  -o boot_custom \
  -b ${ZRT_ENV_TOP_DIR}/firmware/camera/bootloader/boot.bin

```


最终效果就是：

- 新文件前 32 KB：官方固件内容
- 新文件 32 KB 之后：你的 `u-boot-with-spl.bin`

**备份**：操作前务必备份原始 `boot.bin` 和 Flash 中的 `boot` 分区镜像

### 







## 3.调试阶段文件更新
> [!PDF|note] [[Ingenic_Zeratul_T23_开发指南.pdf#page=9&selection=220,0,220,13&color=note|Ingenic_Zeratul_T23_开发指南, p.9]]
> > 调试阶段文件更新与固件烧录
> 
> 

### 

### 

### 

### 



## 4、固件烧录

### 

### 

### 

### 

## 5、恢复与升级
> [!PDF|note] [[Ingenic_Zeratul_T23_开发指南.pdf#page=11&selection=20,0,20,5&color=note|Ingenic_Zeratul_T23_开发指南, p.11]]
> > 恢复与升级
> 
> 

### 

### 

### 

### 
## 6、

### 

### 

### 

### 


## 7、

### 

### 

### 

### 




# 二、快起环境搭建(可能没用到)
> [!PDF|important] [[Ingenic_Zeratul_T23快起环境搭建.pdf#page=5&selection=20,0,20,4&color=important|Ingenic_Zeratul_T23快起环境搭建, p.5]]
> > 环境搭建
> 
> 
## 1.


## 2.
 


## 3.



## 4、


## 5、


## 快速启动测试说明
> [!PDF|note] [[Ingenic_Zeratul_T23快起环境搭建.pdf#page=11&selection=20,0,20,6&color=note|Ingenic_Zeratul_T23快起环境搭建, p.11]]
> > 没有专业设备
> 
> 





# 三、如何添加文件到系统中
[[2.系统分区编译#6、 system 编译]]

## 1.用编译脚本

如果<span style="background:#b1ffff">添加补充文件可以在 os/rootfs/工具链/camera/system 目录下</span>。在顶层目录下执行脚本：
```
./build/build_camera_system.sh -f
```

- 1 麻烦，要先设置环境，再编译内核，再编译system。

## 2.手动压缩

或者对添加其他内容后的<span style="background:#b1ffff"> out/camera/system 文件夹</span>，进行手动的压缩，然后重新烧录 system 分区来达到添加其他文件目的。
具体命令为：
```
mksquashfs system system.bin -comp xz
```

- 1 有出现bin分区被分解的情况。但现在又可以，没问题。

## 3.




# 四、

## 1.

## 2.


## 3.
 






# 五、


## 1.


## 2.



## 3.



# 六、


## 1.

## 2.

## 3.













